delete from `df-data-and-ai.trilliant_warehouse.Thin_thick_seed_block_char` 
    where id_block in (1304082,1949236,1959662,1959662,1592454,1594050,1593069,1358692,1959649,1959649,1958087,1958087,1957362,1957362,1598027,1402220,1402277,1955610,1955610,1957281,1955175,1957281,1955808,1402538,1955175,1955808,1954923,1954923,1351672,1958979,1410774,1958510,1958510,1955159,1953821,1955159,1953707,1953821,1401894,1955171,1958965,1955171,1958965,1953707,1958979,1591909,1304082,1464044,1464044
);
    
    
INSERT INTO `df-data-and-ai.trilliant_warehouse.Thin_thick_seed_block_char`
    (
    SELECT 
    id_block, 
        id_block_run, 
        id_run,
        timestamp, 
        process_name, 
        step_name, 
        step_parameter,
        data, 
        id_run_growth as last_growth 
    
    FROM EXTERNAL_QUERY("dfdb-178217.us.dfdb-trilliant-report-bqconnect",
    '''
    with block_to_find as (select max(id_run_growth) as id_run_growth,id_block from runs_growth_blocks
    where id_block in (1304082,1949236,1959662,1959662,1592454,1594050,1593069,1358692,1959649,1959649,1958087,1958087,1957362,1957362,1598027,1402220,1402277,1955610,1955610,1957281,1955175,1957281,1955808,1402538,1955175,1955808,1954923,1954923,1351672,1958979,1410774,1958510,1958510,1955159,1953821,1955159,1953707,1953821,1401894,1955171,1958965,1955171,1958965,1953707,1958979,1591909,1304082,1464044,1464044
)
group by id_block
),
    
    last_runs as (
    select id_run_growth, id_block,step_parameter, max(id_run) as id_run from vw_block_history
    JOIN block_to_find using(id_block)
    where step_parameter is not null
    and process_name in ('Thin Block Characterization', 'Thick Block Characterization', 'Seed Block Characterization','Large Plate Block Pre HTA Characterization')
       and location_name != 'Diamond Foundry WS'
    group by 1,2,3
    )
    
    
    select id_block, 
        id_block_run, 
        id_run,
        timestamp, 
        process_name, 
        step_name, 
        step_parameter,
        data, 
        id_run_growth
    from 
    vw_block_history 
    join last_runs using(id_block, step_parameter, id_run)
    '''
    )
    );

delete from `df-data-and-ai.trilliant_warehouse.Post_HEP_Char` 
    where id_block in (1889086,1880580,1881214,1892571,1880884,1885507,1881074,1885942,1885802,1880886,1885688,1885472,1936915,1641545,1864214,1874781,1875134,1943492,1944754,1900354,1944192,1576760,1859152,1657831,1943031,1947802,1860860,1943510,1890924,1940871,1938226,1860923,1888121,1942961,1929066,1940929,1942410,1943527,1912644,1859999,1902163,1943505,1861615,1941325,1919393,1947256,1861091,1834397,1916800,1887942,1888716,1943009,1921663,1862193,1941302,1851533,1943032,1947802,1867236,1884930,1899168,1888121,1943170,1947256,1878223,1606159,1875262,1905819,1854568,1947738,1947738,1939648,1880722,1776197,1943623,1928346,1943609,1941473,1941714,1407821,1858280,1941298,1941921,1945469,1945663,1945663,1941423,1889420,1941846,1888716,1945743,1916052,1945263,1859149,1860596,1940734,1889089,1945759,1659086,1941113,1910469,1945743,1941429,1888457,1943290,1943439,1946729,1941807,1947077,1879985,1941234,1943347,1907627,1874030,1948275,1945951,1938645,1775679,1942997,1944734,1940857,1945263,1947202,1889077,1888457,1907627,1940911,1636002,1858953,1910296,1947077,1892074,1936173,1945264,1947202,1933684,1941677,1910968,1927716,1943437,1946288,1947642,1930744,1932751,1936867,1945466,1880906,1945951,1879051,1940535,1654421,1942029,1575430,1929103,1834167,1875297,1946897,1880541,1941821,1945264,1568566,1857390,1927178,1941930,1854447,1881235,1944452,1939425,1669844,1881078,1941088,1879699,1566664,1938865,1948227,1947442,1949313,1943618,1947177,1961574,1917343,1881220,1931583,1942475,1941445,1881225,1929106,1947442,1834224,1879988,1943345,1918550,1941550,1912678,1945666,1946358,1949051,1945666,1946358,1948186,1958199,1880715,1943396,1885795,1887261,1931143,1880578,1881646,1881221,1881073,1889061,1861010,1889070,1881027,1885703,1941652,1961238,1889785,1881634,1881019,1880667,1885800,1881224,1889081,1886095,1881222,1881060,1885441,1885687,1881077,1881071,1880887,1881638,1885520,1881059,1880907,1881064,1880879,1880910,1881237,1885806,1884990,1885759,1885460,1886300,1882113,1881021,1885692);
    
    
INSERT INTO `df-data-and-ai.trilliant_warehouse.Post_HEP_Char`
    (
    SELECT 
    id_block, 
        id_block_run, 
        id_run,
        timestamp, 
        process_name, 
        step_name, 
        step_parameter,
        data
    
    FROM EXTERNAL_QUERY("dfdb-178217.us.dfdb-trilliant-report-bqconnect",
    '''
    with block_to_find as (select max(id_run_growth) as id_run_growth,id_block from runs_growth_blocks
    where id_block in (1889086,1880580,1881214,1892571,1880884,1885507,1881074,1885942,1885802,1880886,1885688,1885472,1936915,1641545,1864214,1874781,1875134,1943492,1944754,1900354,1944192,1576760,1859152,1657831,1943031,1947802,1860860,1943510,1890924,1940871,1938226,1860923,1888121,1942961,1929066,1940929,1942410,1943527,1912644,1859999,1902163,1943505,1861615,1941325,1919393,1947256,1861091,1834397,1916800,1887942,1888716,1943009,1921663,1862193,1941302,1851533,1943032,1947802,1867236,1884930,1899168,1888121,1943170,1947256,1878223,1606159,1875262,1905819,1854568,1947738,1947738,1939648,1880722,1776197,1943623,1928346,1943609,1941473,1941714,1407821,1858280,1941298,1941921,1945469,1945663,1945663,1941423,1889420,1941846,1888716,1945743,1916052,1945263,1859149,1860596,1940734,1889089,1945759,1659086,1941113,1910469,1945743,1941429,1888457,1943290,1943439,1946729,1941807,1947077,1879985,1941234,1943347,1907627,1874030,1948275,1945951,1938645,1775679,1942997,1944734,1940857,1945263,1947202,1889077,1888457,1907627,1940911,1636002,1858953,1910296,1947077,1892074,1936173,1945264,1947202,1933684,1941677,1910968,1927716,1943437,1946288,1947642,1930744,1932751,1936867,1945466,1880906,1945951,1879051,1940535,1654421,1942029,1575430,1929103,1834167,1875297,1946897,1880541,1941821,1945264,1568566,1857390,1927178,1941930,1854447,1881235,1944452,1939425,1669844,1881078,1941088,1879699,1566664,1938865,1948227,1947442,1949313,1943618,1947177,1961574,1917343,1881220,1931583,1942475,1941445,1881225,1929106,1947442,1834224,1879988,1943345,1918550,1941550,1912678,1945666,1946358,1949051,1945666,1946358,1948186,1958199,1880715,1943396,1885795,1887261,1931143,1880578,1881646,1881221,1881073,1889061,1861010,1889070,1881027,1885703,1941652,1961238,1889785,1881634,1881019,1880667,1885800,1881224,1889081,1886095,1881222,1881060,1885441,1885687,1881077,1881071,1880887,1881638,1885520,1881059,1880907,1881064,1880879,1880910,1881237,1885806,1884990,1885759,1885460,1886300,1882113,1881021,1885692

)
group by id_block
),
    
    last_runs as (
    select id_run_growth, id_block,step_parameter, max(id_run) as id_run from vw_block_history
    JOIN block_to_find using(id_block)
    where step_parameter is not null
    and process_name in (		"Post HEP Block Characterization",
		"Post HTA Block Characterization",
		"Large Plate Block Post HTA Characterization",
		"1x1 DS Post HTA Block Char")
       and location_name != 'Diamond Foundry WS'
    group by 1,2,3
    )
    
    
    select id_block, 
        id_block_run, 
        id_run,
        timestamp, 
        process_name, 
        step_name, 
        step_parameter,
        data, 
        id_run_growth
    from 
    vw_block_history 
    join last_runs using(id_block, step_parameter, id_run)
    '''
    )
    );
